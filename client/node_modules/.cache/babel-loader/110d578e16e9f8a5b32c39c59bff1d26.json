{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar decode_codepoint_1 = __importDefault(require(\"entities/lib/decode_codepoint\"));\n\nvar decode_1 = require(\"entities/lib/decode\");\n\nfunction whitespace(c) {\n  return c === 32\n  /* Space */\n  || c === 10\n  /* NewLine */\n  || c === 9\n  /* Tab */\n  || c === 12\n  /* FormFeed */\n  || c === 13\n  /* CarriageReturn */\n  ;\n}\n\nfunction isASCIIAlpha(c) {\n  return c >= 97\n  /* LowerA */\n  && c <= 122\n  /* LowerZ */\n  || c >= 65\n  /* UpperA */\n  && c <= 90\n  /* UpperZ */\n  ;\n}\n\nfunction ifElseState(upper, SUCCESS, FAILURE) {\n  var upperCode = upper.charCodeAt(0);\n  var lowerCode = upper.toLowerCase().charCodeAt(0);\n  return function (t, c) {\n    if (c === lowerCode || c === upperCode) {\n      t._state = SUCCESS;\n    } else {\n      t._state = FAILURE;\n      t._index--;\n    }\n  };\n}\n\nvar stateBeforeCdata1 = ifElseState(\"C\", 24\n/* BeforeCdata2 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata2 = ifElseState(\"D\", 25\n/* BeforeCdata3 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata3 = ifElseState(\"A\", 26\n/* BeforeCdata4 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata4 = ifElseState(\"T\", 27\n/* BeforeCdata5 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeCdata5 = ifElseState(\"A\", 28\n/* BeforeCdata6 */\n, 16\n/* InDeclaration */\n);\nvar stateBeforeScript1 = ifElseState(\"R\", 35\n/* BeforeScript2 */\n, 3\n/* InTagName */\n);\nvar stateBeforeScript2 = ifElseState(\"I\", 36\n/* BeforeScript3 */\n, 3\n/* InTagName */\n);\nvar stateBeforeScript3 = ifElseState(\"P\", 37\n/* BeforeScript4 */\n, 3\n/* InTagName */\n);\nvar stateBeforeScript4 = ifElseState(\"T\", 38\n/* BeforeScript5 */\n, 3\n/* InTagName */\n);\nvar stateAfterScript1 = ifElseState(\"R\", 40\n/* AfterScript2 */\n, 1\n/* Text */\n);\nvar stateAfterScript2 = ifElseState(\"I\", 41\n/* AfterScript3 */\n, 1\n/* Text */\n);\nvar stateAfterScript3 = ifElseState(\"P\", 42\n/* AfterScript4 */\n, 1\n/* Text */\n);\nvar stateAfterScript4 = ifElseState(\"T\", 43\n/* AfterScript5 */\n, 1\n/* Text */\n);\nvar stateBeforeStyle1 = ifElseState(\"Y\", 45\n/* BeforeStyle2 */\n, 3\n/* InTagName */\n);\nvar stateBeforeStyle2 = ifElseState(\"L\", 46\n/* BeforeStyle3 */\n, 3\n/* InTagName */\n);\nvar stateBeforeStyle3 = ifElseState(\"E\", 47\n/* BeforeStyle4 */\n, 3\n/* InTagName */\n);\nvar stateAfterStyle1 = ifElseState(\"Y\", 49\n/* AfterStyle2 */\n, 1\n/* Text */\n);\nvar stateAfterStyle2 = ifElseState(\"L\", 50\n/* AfterStyle3 */\n, 1\n/* Text */\n);\nvar stateAfterStyle3 = ifElseState(\"E\", 51\n/* AfterStyle4 */\n, 1\n/* Text */\n);\nvar stateBeforeSpecialT = ifElseState(\"I\", 54\n/* BeforeTitle1 */\n, 3\n/* InTagName */\n);\nvar stateBeforeTitle1 = ifElseState(\"T\", 55\n/* BeforeTitle2 */\n, 3\n/* InTagName */\n);\nvar stateBeforeTitle2 = ifElseState(\"L\", 56\n/* BeforeTitle3 */\n, 3\n/* InTagName */\n);\nvar stateBeforeTitle3 = ifElseState(\"E\", 57\n/* BeforeTitle4 */\n, 3\n/* InTagName */\n);\nvar stateBeforeSpecialTEnd = ifElseState(\"I\", 58\n/* AfterTitle1 */\n, 1\n/* Text */\n);\nvar stateAfterTitle1 = ifElseState(\"T\", 59\n/* AfterTitle2 */\n, 1\n/* Text */\n);\nvar stateAfterTitle2 = ifElseState(\"L\", 60\n/* AfterTitle3 */\n, 1\n/* Text */\n);\nvar stateAfterTitle3 = ifElseState(\"E\", 61\n/* AfterTitle4 */\n, 1\n/* Text */\n);\nvar stateBeforeNumericEntity = ifElseState(\"X\", 66\n/* InHexEntity */\n, 65\n/* InNumericEntity */\n);\n\nvar Tokenizer = function () {\n  function Tokenizer(_a, cbs) {\n    var _b = _a.xmlMode,\n        xmlMode = _b === void 0 ? false : _b,\n        _c = _a.decodeEntities,\n        decodeEntities = _c === void 0 ? true : _c;\n    this.cbs = cbs;\n    /** The current state the tokenizer is in. */\n\n    this._state = 1\n    /* Text */\n    ;\n    /** The read buffer. */\n\n    this.buffer = \"\";\n    /** The beginning of the section that is currently being read. */\n\n    this.sectionStart = 0;\n    /** The index within the buffer that we are currently looking at. */\n\n    this._index = 0;\n    /**\n     * Data that has already been processed will be removed from the buffer occasionally.\n     * `_bufferOffset` keeps track of how many characters have been removed, to make sure position information is accurate.\n     */\n\n    this.bufferOffset = 0;\n    /** Some behavior, eg. when decoding entities, is done while we are in another state. This keeps track of the other state type. */\n\n    this.baseState = 1\n    /* Text */\n    ;\n    /** For special parsing behavior inside of script and style tags. */\n\n    this.special = 1\n    /* None */\n    ;\n    /** Indicates whether the tokenizer has been paused. */\n\n    this.running = true;\n    /** Indicates whether the tokenizer has finished running / `.end` has been called. */\n\n    this.ended = false;\n    this.trieIndex = 0;\n    this.trieCurrent = 0;\n    this.trieResult = null;\n    this.trieExcess = 0;\n    this.xmlMode = xmlMode;\n    this.decodeEntities = decodeEntities;\n    this.entityTrie = xmlMode ? decode_1.xmlDecodeTree : decode_1.htmlDecodeTree;\n  }\n\n  Tokenizer.prototype.reset = function () {\n    this._state = 1\n    /* Text */\n    ;\n    this.buffer = \"\";\n    this.sectionStart = 0;\n    this._index = 0;\n    this.bufferOffset = 0;\n    this.baseState = 1\n    /* Text */\n    ;\n    this.special = 1\n    /* None */\n    ;\n    this.running = true;\n    this.ended = false;\n  };\n\n  Tokenizer.prototype.write = function (chunk) {\n    if (this.ended) return this.cbs.onerror(Error(\".write() after done!\"));\n    if (this.buffer.length) this.buffer += chunk;else this.buffer = chunk;\n    this.parse();\n  };\n\n  Tokenizer.prototype.end = function (chunk) {\n    if (this.ended) return this.cbs.onerror(Error(\".end() after done!\"));\n    if (chunk) this.write(chunk);\n    this.ended = true;\n    if (this.running) this.finish();\n  };\n\n  Tokenizer.prototype.pause = function () {\n    this.running = false;\n  };\n\n  Tokenizer.prototype.resume = function () {\n    this.running = true;\n\n    if (this._index < this.buffer.length) {\n      this.parse();\n    }\n\n    if (this.ended) {\n      this.finish();\n    }\n  };\n  /**\n   * The start of the current section.\n   */\n\n\n  Tokenizer.prototype.getAbsoluteSectionStart = function () {\n    return this.sectionStart + this.bufferOffset;\n  };\n  /**\n   * The current index within all of the written data.\n   */\n\n\n  Tokenizer.prototype.getAbsoluteIndex = function () {\n    return this.bufferOffset + this._index;\n  };\n\n  Tokenizer.prototype.stateText = function (c) {\n    if (c === 60\n    /* Lt */\n    ) {\n      if (this._index > this.sectionStart) {\n        this.cbs.ontext(this.getSection());\n      }\n\n      this._state = 2\n      /* BeforeTagName */\n      ;\n      this.sectionStart = this._index;\n    } else if (this.decodeEntities && c === 38\n    /* Amp */\n    && (this.special === 1\n    /* None */\n    || this.special === 4\n    /* Title */\n    )) {\n      if (this._index > this.sectionStart) {\n        this.cbs.ontext(this.getSection());\n      }\n\n      this.baseState = 1\n      /* Text */\n      ;\n      this._state = 62\n      /* BeforeEntity */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n  /**\n   * HTML only allows ASCII alpha characters (a-z and A-Z) at the beginning of a tag name.\n   *\n   * XML allows a lot more characters here (@see https://www.w3.org/TR/REC-xml/#NT-NameStartChar).\n   * We allow anything that wouldn't end the tag.\n   */\n\n\n  Tokenizer.prototype.isTagStartChar = function (c) {\n    return isASCIIAlpha(c) || this.xmlMode && !whitespace(c) && c !== 47\n    /* Slash */\n    && c !== 62\n    /* Gt */\n    ;\n  };\n\n  Tokenizer.prototype.stateBeforeTagName = function (c) {\n    if (c === 47\n    /* Slash */\n    ) {\n      this._state = 5\n      /* BeforeClosingTagName */\n      ;\n    } else if (c === 60\n    /* Lt */\n    ) {\n      this.cbs.ontext(this.getSection());\n      this.sectionStart = this._index;\n    } else if (c === 62\n    /* Gt */\n    || this.special !== 1\n    /* None */\n    || whitespace(c)) {\n      this._state = 1\n      /* Text */\n      ;\n    } else if (c === 33\n    /* ExclamationMark */\n    ) {\n      this._state = 15\n      /* BeforeDeclaration */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c === 63\n    /* Questionmark */\n    ) {\n      this._state = 17\n      /* InProcessingInstruction */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (!this.isTagStartChar(c)) {\n      this._state = 1\n      /* Text */\n      ;\n    } else {\n      this._state = !this.xmlMode && (c === 115\n      /* LowerS */\n      || c === 83\n      /* UpperS */\n      ) ? 32\n      /* BeforeSpecialS */\n      : !this.xmlMode && (c === 116\n      /* LowerT */\n      || c === 84\n      /* UpperT */\n      ) ? 52\n      /* BeforeSpecialT */\n      : 3\n      /* InTagName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInTagName = function (c) {\n    if (c === 47\n    /* Slash */\n    || c === 62\n    /* Gt */\n    || whitespace(c)) {\n      this.cbs.onopentagname(this.getSection());\n      this.sectionStart = -1;\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this.stateBeforeAttributeName(c);\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeClosingTagName = function (c) {\n    if (whitespace(c)) {// Ignore\n    } else if (c === 62\n    /* Gt */\n    ) {\n      this._state = 1\n      /* Text */\n      ;\n    } else if (this.special !== 1\n    /* None */\n    ) {\n      if (this.special !== 4\n      /* Title */\n      && (c === 115\n      /* LowerS */\n      || c === 83\n      /* UpperS */\n      )) {\n        this._state = 33\n        /* BeforeSpecialSEnd */\n        ;\n      } else if (this.special === 4\n      /* Title */\n      && (c === 116\n      /* LowerT */\n      || c === 84\n      /* UpperT */\n      )) {\n        this._state = 53\n        /* BeforeSpecialTEnd */\n        ;\n      } else {\n        this._state = 1\n        /* Text */\n        ;\n        this.stateText(c);\n      }\n    } else if (!this.isTagStartChar(c)) {\n      this._state = 20\n      /* InSpecialComment */\n      ;\n      this.sectionStart = this._index;\n    } else {\n      this._state = 6\n      /* InClosingTagName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInClosingTagName = function (c) {\n    if (c === 62\n    /* Gt */\n    || whitespace(c)) {\n      this.cbs.onclosetag(this.getSection());\n      this.sectionStart = -1;\n      this._state = 7\n      /* AfterClosingTagName */\n      ;\n      this.stateAfterClosingTagName(c);\n    }\n  };\n\n  Tokenizer.prototype.stateAfterClosingTagName = function (c) {\n    // Skip everything until \">\"\n    if (c === 62\n    /* Gt */\n    ) {\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeAttributeName = function (c) {\n    if (c === 62\n    /* Gt */\n    ) {\n      this.cbs.onopentagend();\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c === 47\n    /* Slash */\n    ) {\n      this._state = 4\n      /* InSelfClosingTag */\n      ;\n    } else if (!whitespace(c)) {\n      this._state = 9\n      /* InAttributeName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInSelfClosingTag = function (c) {\n    if (c === 62\n    /* Gt */\n    ) {\n      this.cbs.onselfclosingtag();\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n      this.special = 1\n      /* None */\n      ; // Reset special state, in case of self-closing special tags\n    } else if (!whitespace(c)) {\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this.stateBeforeAttributeName(c);\n    }\n  };\n\n  Tokenizer.prototype.stateInAttributeName = function (c) {\n    if (c === 61\n    /* Eq */\n    || c === 47\n    /* Slash */\n    || c === 62\n    /* Gt */\n    || whitespace(c)) {\n      this.cbs.onattribname(this.getSection());\n      this.sectionStart = -1;\n      this._state = 10\n      /* AfterAttributeName */\n      ;\n      this.stateAfterAttributeName(c);\n    }\n  };\n\n  Tokenizer.prototype.stateAfterAttributeName = function (c) {\n    if (c === 61\n    /* Eq */\n    ) {\n      this._state = 11\n      /* BeforeAttributeValue */\n      ;\n    } else if (c === 47\n    /* Slash */\n    || c === 62\n    /* Gt */\n    ) {\n      this.cbs.onattribend(undefined);\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this.stateBeforeAttributeName(c);\n    } else if (!whitespace(c)) {\n      this.cbs.onattribend(undefined);\n      this._state = 9\n      /* InAttributeName */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeAttributeValue = function (c) {\n    if (c === 34\n    /* DoubleQuote */\n    ) {\n      this._state = 12\n      /* InAttributeValueDq */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c === 39\n    /* SingleQuote */\n    ) {\n      this._state = 13\n      /* InAttributeValueSq */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (!whitespace(c)) {\n      this.sectionStart = this._index;\n      this._state = 14\n      /* InAttributeValueNq */\n      ;\n      this.stateInAttributeValueNoQuotes(c); // Reconsume token\n    }\n  };\n\n  Tokenizer.prototype.handleInAttributeValue = function (c, quote) {\n    if (c === quote) {\n      this.cbs.onattribdata(this.getSection());\n      this.sectionStart = -1;\n      this.cbs.onattribend(String.fromCharCode(quote));\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n    } else if (this.decodeEntities && c === 38\n    /* Amp */\n    ) {\n      this.cbs.onattribdata(this.getSection());\n      this.baseState = this._state;\n      this._state = 62\n      /* BeforeEntity */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateInAttributeValueDoubleQuotes = function (c) {\n    this.handleInAttributeValue(c, 34\n    /* DoubleQuote */\n    );\n  };\n\n  Tokenizer.prototype.stateInAttributeValueSingleQuotes = function (c) {\n    this.handleInAttributeValue(c, 39\n    /* SingleQuote */\n    );\n  };\n\n  Tokenizer.prototype.stateInAttributeValueNoQuotes = function (c) {\n    if (whitespace(c) || c === 62\n    /* Gt */\n    ) {\n      this.cbs.onattribdata(this.getSection());\n      this.sectionStart = -1;\n      this.cbs.onattribend(null);\n      this._state = 8\n      /* BeforeAttributeName */\n      ;\n      this.stateBeforeAttributeName(c);\n    } else if (this.decodeEntities && c === 38\n    /* Amp */\n    ) {\n      this.cbs.onattribdata(this.getSection());\n      this.baseState = this._state;\n      this._state = 62\n      /* BeforeEntity */\n      ;\n      this.sectionStart = this._index;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeDeclaration = function (c) {\n    this._state = c === 91\n    /* OpeningSquareBracket */\n    ? 23\n    /* BeforeCdata1 */\n    : c === 45\n    /* Dash */\n    ? 18\n    /* BeforeComment */\n    : 16\n    /* InDeclaration */\n    ;\n  };\n\n  Tokenizer.prototype.stateInDeclaration = function (c) {\n    if (c === 62\n    /* Gt */\n    ) {\n      this.cbs.ondeclaration(this.getSection());\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateInProcessingInstruction = function (c) {\n    if (c === 62\n    /* Gt */\n    ) {\n      this.cbs.onprocessinginstruction(this.getSection());\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeComment = function (c) {\n    if (c === 45\n    /* Dash */\n    ) {\n      this._state = 19\n      /* InComment */\n      ;\n      this.sectionStart = this._index + 1;\n    } else {\n      this._state = 16\n      /* InDeclaration */\n      ;\n    }\n  };\n\n  Tokenizer.prototype.stateInComment = function (c) {\n    if (c === 45\n    /* Dash */\n    ) this._state = 21\n    /* AfterComment1 */\n    ;\n  };\n\n  Tokenizer.prototype.stateInSpecialComment = function (c) {\n    if (c === 62\n    /* Gt */\n    ) {\n      this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index));\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    }\n  };\n\n  Tokenizer.prototype.stateAfterComment1 = function (c) {\n    if (c === 45\n    /* Dash */\n    ) {\n      this._state = 22\n      /* AfterComment2 */\n      ;\n    } else {\n      this._state = 19\n      /* InComment */\n      ;\n    }\n  };\n\n  Tokenizer.prototype.stateAfterComment2 = function (c) {\n    if (c === 62\n    /* Gt */\n    ) {\n      // Remove 2 trailing chars\n      this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index - 2));\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c !== 45\n    /* Dash */\n    ) {\n      this._state = 19\n      /* InComment */\n      ;\n    } // Else: stay in AFTER_COMMENT_2 (`--->`)\n\n  };\n\n  Tokenizer.prototype.stateBeforeCdata6 = function (c) {\n    if (c === 91\n    /* OpeningSquareBracket */\n    ) {\n      this._state = 29\n      /* InCdata */\n      ;\n      this.sectionStart = this._index + 1;\n    } else {\n      this._state = 16\n      /* InDeclaration */\n      ;\n      this.stateInDeclaration(c);\n    }\n  };\n\n  Tokenizer.prototype.stateInCdata = function (c) {\n    if (c === 93\n    /* ClosingSquareBracket */\n    ) this._state = 30\n    /* AfterCdata1 */\n    ;\n  };\n\n  Tokenizer.prototype.stateAfterCdata1 = function (c) {\n    if (c === 93\n    /* ClosingSquareBracket */\n    ) this._state = 31\n    /* AfterCdata2 */\n    ;else this._state = 29\n    /* InCdata */\n    ;\n  };\n\n  Tokenizer.prototype.stateAfterCdata2 = function (c) {\n    if (c === 62\n    /* Gt */\n    ) {\n      // Remove 2 trailing chars\n      this.cbs.oncdata(this.buffer.substring(this.sectionStart, this._index - 2));\n      this._state = 1\n      /* Text */\n      ;\n      this.sectionStart = this._index + 1;\n    } else if (c !== 93\n    /* ClosingSquareBracket */\n    ) {\n      this._state = 29\n      /* InCdata */\n      ;\n    } // Else: stay in AFTER_CDATA_2 (`]]]>`)\n\n  };\n\n  Tokenizer.prototype.stateBeforeSpecialS = function (c) {\n    if (c === 99\n    /* LowerC */\n    || c === 67\n    /* UpperC */\n    ) {\n      this._state = 34\n      /* BeforeScript1 */\n      ;\n    } else if (c === 116\n    /* LowerT */\n    || c === 84\n    /* UpperT */\n    ) {\n      this._state = 44\n      /* BeforeStyle1 */\n      ;\n    } else {\n      this._state = 3\n      /* InTagName */\n      ;\n      this.stateInTagName(c); // Consume the token again\n    }\n  };\n\n  Tokenizer.prototype.stateBeforeSpecialSEnd = function (c) {\n    if (this.special === 2\n    /* Script */\n    && (c === 99\n    /* LowerC */\n    || c === 67\n    /* UpperC */\n    )) {\n      this._state = 39\n      /* AfterScript1 */\n      ;\n    } else if (this.special === 3\n    /* Style */\n    && (c === 116\n    /* LowerT */\n    || c === 84\n    /* UpperT */\n    )) {\n      this._state = 48\n      /* AfterStyle1 */\n      ;\n    } else this._state = 1\n    /* Text */\n    ;\n  };\n\n  Tokenizer.prototype.stateBeforeSpecialLast = function (c, special) {\n    if (c === 47\n    /* Slash */\n    || c === 62\n    /* Gt */\n    || whitespace(c)) {\n      this.special = special;\n    }\n\n    this._state = 3\n    /* InTagName */\n    ;\n    this.stateInTagName(c); // Consume the token again\n  };\n\n  Tokenizer.prototype.stateAfterSpecialLast = function (c, sectionStartOffset) {\n    if (c === 62\n    /* Gt */\n    || whitespace(c)) {\n      this.sectionStart = this._index - sectionStartOffset;\n      this.special = 1\n      /* None */\n      ;\n      this._state = 6\n      /* InClosingTagName */\n      ;\n      this.stateInClosingTagName(c); // Reconsume the token\n    } else this._state = 1\n    /* Text */\n    ;\n  };\n\n  Tokenizer.prototype.stateBeforeEntity = function (c) {\n    if (c === 35\n    /* Num */\n    ) {\n      this._state = 63\n      /* BeforeNumericEntity */\n      ;\n    } else if (c === 38\n    /* Amp */\n    ) {\n      // We have two `&` characters in a row. Emit the first one.\n      this.emitPartial(this.getSection());\n      this.sectionStart = this._index;\n    } else {\n      this._state = 64\n      /* InNamedEntity */\n      ;\n      this.trieIndex = 0;\n      this.trieCurrent = this.entityTrie[0];\n      this.trieResult = null; // Start excess with 1 to include the '&'\n\n      this.trieExcess = 1;\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateInNamedEntity = function (c) {\n    this.trieExcess += 1;\n    this.trieIndex = (0, decode_1.determineBranch)(this.entityTrie, this.trieCurrent, this.trieIndex + 1, c);\n\n    if (this.trieIndex < 0) {\n      this.emitNamedEntity();\n      this._index--;\n      return;\n    }\n\n    this.trieCurrent = this.entityTrie[this.trieIndex]; // If the branch is a value, store it and continue\n\n    if (this.trieCurrent & decode_1.BinTrieFlags.HAS_VALUE) {\n      // If we have a legacy entity while parsing strictly, just skip the number of bytes\n      if (!this.allowLegacyEntity() && c !== 59\n      /* Semi */\n      ) {\n        // No need to consider multi-byte values, as the legacy entity is always a single byte\n        this.trieIndex += 1;\n      } else {\n        // If this is a surrogate pair, combine the higher bits from the node with the next byte\n        this.trieResult = this.trieCurrent & decode_1.BinTrieFlags.MULTI_BYTE ? String.fromCharCode(this.entityTrie[++this.trieIndex], this.entityTrie[++this.trieIndex]) : String.fromCharCode(this.entityTrie[++this.trieIndex]);\n        this.trieExcess = 0;\n      }\n    }\n  };\n\n  Tokenizer.prototype.emitNamedEntity = function () {\n    if (this.trieResult) {\n      this.emitPartial(this.trieResult);\n    }\n\n    this.sectionStart = this._index - this.trieExcess + 1;\n    this._state = this.baseState;\n  };\n\n  Tokenizer.prototype.decodeNumericEntity = function (base, strict) {\n    var sectionStart = this.sectionStart + 2 + (base >> 4);\n\n    if (sectionStart !== this._index) {\n      // Parse entity\n      var entity = this.buffer.substring(sectionStart, this._index);\n      var parsed = parseInt(entity, base);\n      this.emitPartial((0, decode_codepoint_1.default)(parsed));\n      this.sectionStart = this._index + Number(strict);\n    }\n\n    this._state = this.baseState;\n  };\n\n  Tokenizer.prototype.stateInNumericEntity = function (c) {\n    if (c === 59\n    /* Semi */\n    ) {\n      this.decodeNumericEntity(10, true);\n    } else if (c < 48\n    /* Zero */\n    || c > 57\n    /* Nine */\n    ) {\n      if (this.allowLegacyEntity()) {\n        this.decodeNumericEntity(10, false);\n      } else {\n        this._state = this.baseState;\n      }\n\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.stateInHexEntity = function (c) {\n    if (c === 59\n    /* Semi */\n    ) {\n      this.decodeNumericEntity(16, true);\n    } else if ((c < 97\n    /* LowerA */\n    || c > 102\n    /* LowerF */\n    ) && (c < 65\n    /* UpperA */\n    || c > 70\n    /* UpperF */\n    ) && (c < 48\n    /* Zero */\n    || c > 57\n    /* Nine */\n    )) {\n      if (this.allowLegacyEntity()) {\n        this.decodeNumericEntity(16, false);\n      } else {\n        this._state = this.baseState;\n      }\n\n      this._index--;\n    }\n  };\n\n  Tokenizer.prototype.allowLegacyEntity = function () {\n    return !this.xmlMode && this.baseState === 1\n    /* Text */\n    ;\n  };\n  /**\n   * Remove data that has already been consumed from the buffer.\n   */\n\n\n  Tokenizer.prototype.cleanup = function () {\n    // If we are inside of text, emit what we already have.\n    if (this.running && this._state === 1\n    /* Text */\n    && this.sectionStart !== this._index) {\n      // TODO: We could emit attribute data here as well.\n      this.cbs.ontext(this.buffer.substr(this.sectionStart));\n      this.sectionStart = this._index;\n    }\n\n    var start = this.sectionStart < 0 ? this._index : this.sectionStart;\n    this.buffer = start === this.buffer.length ? \"\" : this.buffer.substr(start);\n    this._index -= start;\n    this.bufferOffset += start;\n\n    if (this.sectionStart > 0) {\n      this.sectionStart = 0;\n    }\n  };\n  /**\n   * Iterates through the buffer, calling the function corresponding to the current state.\n   *\n   * States that are more likely to be hit are higher up, as a performance improvement.\n   */\n\n\n  Tokenizer.prototype.parse = function () {\n    while (this._index < this.buffer.length && this.running) {\n      var c = this.buffer.charCodeAt(this._index);\n\n      if (this._state === 1\n      /* Text */\n      ) {\n        this.stateText(c);\n      } else if (this._state === 12\n      /* InAttributeValueDq */\n      ) {\n        this.stateInAttributeValueDoubleQuotes(c);\n      } else if (this._state === 9\n      /* InAttributeName */\n      ) {\n        this.stateInAttributeName(c);\n      } else if (this._state === 19\n      /* InComment */\n      ) {\n        this.stateInComment(c);\n      } else if (this._state === 20\n      /* InSpecialComment */\n      ) {\n        this.stateInSpecialComment(c);\n      } else if (this._state === 8\n      /* BeforeAttributeName */\n      ) {\n        this.stateBeforeAttributeName(c);\n      } else if (this._state === 3\n      /* InTagName */\n      ) {\n        this.stateInTagName(c);\n      } else if (this._state === 6\n      /* InClosingTagName */\n      ) {\n        this.stateInClosingTagName(c);\n      } else if (this._state === 2\n      /* BeforeTagName */\n      ) {\n        this.stateBeforeTagName(c);\n      } else if (this._state === 10\n      /* AfterAttributeName */\n      ) {\n        this.stateAfterAttributeName(c);\n      } else if (this._state === 13\n      /* InAttributeValueSq */\n      ) {\n        this.stateInAttributeValueSingleQuotes(c);\n      } else if (this._state === 11\n      /* BeforeAttributeValue */\n      ) {\n        this.stateBeforeAttributeValue(c);\n      } else if (this._state === 5\n      /* BeforeClosingTagName */\n      ) {\n        this.stateBeforeClosingTagName(c);\n      } else if (this._state === 7\n      /* AfterClosingTagName */\n      ) {\n        this.stateAfterClosingTagName(c);\n      } else if (this._state === 32\n      /* BeforeSpecialS */\n      ) {\n        this.stateBeforeSpecialS(c);\n      } else if (this._state === 21\n      /* AfterComment1 */\n      ) {\n        this.stateAfterComment1(c);\n      } else if (this._state === 14\n      /* InAttributeValueNq */\n      ) {\n        this.stateInAttributeValueNoQuotes(c);\n      } else if (this._state === 4\n      /* InSelfClosingTag */\n      ) {\n        this.stateInSelfClosingTag(c);\n      } else if (this._state === 16\n      /* InDeclaration */\n      ) {\n        this.stateInDeclaration(c);\n      } else if (this._state === 15\n      /* BeforeDeclaration */\n      ) {\n        this.stateBeforeDeclaration(c);\n      } else if (this._state === 22\n      /* AfterComment2 */\n      ) {\n        this.stateAfterComment2(c);\n      } else if (this._state === 18\n      /* BeforeComment */\n      ) {\n        this.stateBeforeComment(c);\n      } else if (this._state === 33\n      /* BeforeSpecialSEnd */\n      ) {\n        this.stateBeforeSpecialSEnd(c);\n      } else if (this._state === 53\n      /* BeforeSpecialTEnd */\n      ) {\n        stateBeforeSpecialTEnd(this, c);\n      } else if (this._state === 39\n      /* AfterScript1 */\n      ) {\n        stateAfterScript1(this, c);\n      } else if (this._state === 40\n      /* AfterScript2 */\n      ) {\n        stateAfterScript2(this, c);\n      } else if (this._state === 41\n      /* AfterScript3 */\n      ) {\n        stateAfterScript3(this, c);\n      } else if (this._state === 34\n      /* BeforeScript1 */\n      ) {\n        stateBeforeScript1(this, c);\n      } else if (this._state === 35\n      /* BeforeScript2 */\n      ) {\n        stateBeforeScript2(this, c);\n      } else if (this._state === 36\n      /* BeforeScript3 */\n      ) {\n        stateBeforeScript3(this, c);\n      } else if (this._state === 37\n      /* BeforeScript4 */\n      ) {\n        stateBeforeScript4(this, c);\n      } else if (this._state === 38\n      /* BeforeScript5 */\n      ) {\n        this.stateBeforeSpecialLast(c, 2\n        /* Script */\n        );\n      } else if (this._state === 42\n      /* AfterScript4 */\n      ) {\n        stateAfterScript4(this, c);\n      } else if (this._state === 43\n      /* AfterScript5 */\n      ) {\n        this.stateAfterSpecialLast(c, 6);\n      } else if (this._state === 44\n      /* BeforeStyle1 */\n      ) {\n        stateBeforeStyle1(this, c);\n      } else if (this._state === 29\n      /* InCdata */\n      ) {\n        this.stateInCdata(c);\n      } else if (this._state === 45\n      /* BeforeStyle2 */\n      ) {\n        stateBeforeStyle2(this, c);\n      } else if (this._state === 46\n      /* BeforeStyle3 */\n      ) {\n        stateBeforeStyle3(this, c);\n      } else if (this._state === 47\n      /* BeforeStyle4 */\n      ) {\n        this.stateBeforeSpecialLast(c, 3\n        /* Style */\n        );\n      } else if (this._state === 48\n      /* AfterStyle1 */\n      ) {\n        stateAfterStyle1(this, c);\n      } else if (this._state === 49\n      /* AfterStyle2 */\n      ) {\n        stateAfterStyle2(this, c);\n      } else if (this._state === 50\n      /* AfterStyle3 */\n      ) {\n        stateAfterStyle3(this, c);\n      } else if (this._state === 51\n      /* AfterStyle4 */\n      ) {\n        this.stateAfterSpecialLast(c, 5);\n      } else if (this._state === 52\n      /* BeforeSpecialT */\n      ) {\n        stateBeforeSpecialT(this, c);\n      } else if (this._state === 54\n      /* BeforeTitle1 */\n      ) {\n        stateBeforeTitle1(this, c);\n      } else if (this._state === 55\n      /* BeforeTitle2 */\n      ) {\n        stateBeforeTitle2(this, c);\n      } else if (this._state === 56\n      /* BeforeTitle3 */\n      ) {\n        stateBeforeTitle3(this, c);\n      } else if (this._state === 57\n      /* BeforeTitle4 */\n      ) {\n        this.stateBeforeSpecialLast(c, 4\n        /* Title */\n        );\n      } else if (this._state === 58\n      /* AfterTitle1 */\n      ) {\n        stateAfterTitle1(this, c);\n      } else if (this._state === 59\n      /* AfterTitle2 */\n      ) {\n        stateAfterTitle2(this, c);\n      } else if (this._state === 60\n      /* AfterTitle3 */\n      ) {\n        stateAfterTitle3(this, c);\n      } else if (this._state === 61\n      /* AfterTitle4 */\n      ) {\n        this.stateAfterSpecialLast(c, 5);\n      } else if (this._state === 17\n      /* InProcessingInstruction */\n      ) {\n        this.stateInProcessingInstruction(c);\n      } else if (this._state === 64\n      /* InNamedEntity */\n      ) {\n        this.stateInNamedEntity(c);\n      } else if (this._state === 23\n      /* BeforeCdata1 */\n      ) {\n        stateBeforeCdata1(this, c);\n      } else if (this._state === 62\n      /* BeforeEntity */\n      ) {\n        this.stateBeforeEntity(c);\n      } else if (this._state === 24\n      /* BeforeCdata2 */\n      ) {\n        stateBeforeCdata2(this, c);\n      } else if (this._state === 25\n      /* BeforeCdata3 */\n      ) {\n        stateBeforeCdata3(this, c);\n      } else if (this._state === 30\n      /* AfterCdata1 */\n      ) {\n        this.stateAfterCdata1(c);\n      } else if (this._state === 31\n      /* AfterCdata2 */\n      ) {\n        this.stateAfterCdata2(c);\n      } else if (this._state === 26\n      /* BeforeCdata4 */\n      ) {\n        stateBeforeCdata4(this, c);\n      } else if (this._state === 27\n      /* BeforeCdata5 */\n      ) {\n        stateBeforeCdata5(this, c);\n      } else if (this._state === 28\n      /* BeforeCdata6 */\n      ) {\n        this.stateBeforeCdata6(c);\n      } else if (this._state === 66\n      /* InHexEntity */\n      ) {\n        this.stateInHexEntity(c);\n      } else if (this._state === 65\n      /* InNumericEntity */\n      ) {\n        this.stateInNumericEntity(c);\n      } else {\n        // `this._state === State.BeforeNumericEntity`\n        stateBeforeNumericEntity(this, c);\n      }\n\n      this._index++;\n    }\n\n    this.cleanup();\n  };\n\n  Tokenizer.prototype.finish = function () {\n    // If there is remaining data, emit it in a reasonable way\n    if (this.sectionStart < this._index) {\n      this.handleTrailingData();\n    }\n\n    this.cbs.onend();\n  };\n  /** Handle any trailing data. */\n\n\n  Tokenizer.prototype.handleTrailingData = function () {\n    var data = this.buffer.substr(this.sectionStart);\n\n    if (this._state === 29\n    /* InCdata */\n    || this._state === 30\n    /* AfterCdata1 */\n    || this._state === 31\n    /* AfterCdata2 */\n    ) {\n      this.cbs.oncdata(data);\n    } else if (this._state === 19\n    /* InComment */\n    || this._state === 21\n    /* AfterComment1 */\n    || this._state === 22\n    /* AfterComment2 */\n    ) {\n      this.cbs.oncomment(data);\n    } else if (this._state === 64\n    /* InNamedEntity */\n    && !this.xmlMode) {\n      // Increase excess for EOF\n      this.trieExcess++;\n      this.emitNamedEntity();\n\n      if (this.sectionStart < this._index) {\n        this._state = this.baseState;\n        this.handleTrailingData();\n      }\n    } else if (this._state === 65\n    /* InNumericEntity */\n    && !this.xmlMode) {\n      this.decodeNumericEntity(10, false); // All trailing data will have been consumed\n    } else if (this._state === 66\n    /* InHexEntity */\n    && !this.xmlMode) {\n      this.decodeNumericEntity(16, false); // All trailing data will have been consumed\n    } else if (this._state === 3\n    /* InTagName */\n    || this._state === 8\n    /* BeforeAttributeName */\n    || this._state === 11\n    /* BeforeAttributeValue */\n    || this._state === 10\n    /* AfterAttributeName */\n    || this._state === 9\n    /* InAttributeName */\n    || this._state === 13\n    /* InAttributeValueSq */\n    || this._state === 12\n    /* InAttributeValueDq */\n    || this._state === 14\n    /* InAttributeValueNq */\n    || this._state === 6\n    /* InClosingTagName */\n    ) {\n      /*\n       * If we are currently in an opening or closing tag, us not calling the\n       * respective callback signals that the tag should be ignored.\n       */\n    } else {\n      this.cbs.ontext(data);\n    }\n  };\n\n  Tokenizer.prototype.getSection = function () {\n    return this.buffer.substring(this.sectionStart, this._index);\n  };\n\n  Tokenizer.prototype.emitPartial = function (value) {\n    if (this.baseState !== 1\n    /* Text */\n    ) {\n      this.cbs.onattribdata(value);\n    } else {\n      this.cbs.ontext(value);\n    }\n  };\n\n  return Tokenizer;\n}();\n\nexports.default = Tokenizer;","map":{"version":3,"sources":["/Users/camintosh2/node_modules/htmlparser2/lib/Tokenizer.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","decode_codepoint_1","require","decode_1","whitespace","c","isASCIIAlpha","ifElseState","upper","SUCCESS","FAILURE","upperCode","charCodeAt","lowerCode","toLowerCase","t","_state","_index","stateBeforeCdata1","stateBeforeCdata2","stateBeforeCdata3","stateBeforeCdata4","stateBeforeCdata5","stateBeforeScript1","stateBeforeScript2","stateBeforeScript3","stateBeforeScript4","stateAfterScript1","stateAfterScript2","stateAfterScript3","stateAfterScript4","stateBeforeStyle1","stateBeforeStyle2","stateBeforeStyle3","stateAfterStyle1","stateAfterStyle2","stateAfterStyle3","stateBeforeSpecialT","stateBeforeTitle1","stateBeforeTitle2","stateBeforeTitle3","stateBeforeSpecialTEnd","stateAfterTitle1","stateAfterTitle2","stateAfterTitle3","stateBeforeNumericEntity","Tokenizer","_a","cbs","_b","xmlMode","_c","decodeEntities","buffer","sectionStart","bufferOffset","baseState","special","running","ended","trieIndex","trieCurrent","trieResult","trieExcess","entityTrie","xmlDecodeTree","htmlDecodeTree","prototype","reset","write","chunk","onerror","Error","length","parse","end","finish","pause","resume","getAbsoluteSectionStart","getAbsoluteIndex","stateText","ontext","getSection","isTagStartChar","stateBeforeTagName","stateInTagName","onopentagname","stateBeforeAttributeName","stateBeforeClosingTagName","stateInClosingTagName","onclosetag","stateAfterClosingTagName","onopentagend","stateInSelfClosingTag","onselfclosingtag","stateInAttributeName","onattribname","stateAfterAttributeName","onattribend","undefined","stateBeforeAttributeValue","stateInAttributeValueNoQuotes","handleInAttributeValue","quote","onattribdata","String","fromCharCode","stateInAttributeValueDoubleQuotes","stateInAttributeValueSingleQuotes","stateBeforeDeclaration","stateInDeclaration","ondeclaration","stateInProcessingInstruction","onprocessinginstruction","stateBeforeComment","stateInComment","stateInSpecialComment","oncomment","substring","stateAfterComment1","stateAfterComment2","stateBeforeCdata6","stateInCdata","stateAfterCdata1","stateAfterCdata2","oncdata","stateBeforeSpecialS","stateBeforeSpecialSEnd","stateBeforeSpecialLast","stateAfterSpecialLast","sectionStartOffset","stateBeforeEntity","emitPartial","stateInNamedEntity","determineBranch","emitNamedEntity","BinTrieFlags","HAS_VALUE","allowLegacyEntity","MULTI_BYTE","decodeNumericEntity","base","strict","entity","parsed","parseInt","default","Number","stateInNumericEntity","stateInHexEntity","cleanup","substr","start","handleTrailingData","onend","data"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar decode_codepoint_1 = __importDefault(require(\"entities/lib/decode_codepoint\"));\nvar decode_1 = require(\"entities/lib/decode\");\nfunction whitespace(c) {\n    return (c === 32 /* Space */ ||\n        c === 10 /* NewLine */ ||\n        c === 9 /* Tab */ ||\n        c === 12 /* FormFeed */ ||\n        c === 13 /* CarriageReturn */);\n}\nfunction isASCIIAlpha(c) {\n    return ((c >= 97 /* LowerA */ && c <= 122 /* LowerZ */) ||\n        (c >= 65 /* UpperA */ && c <= 90 /* UpperZ */));\n}\nfunction ifElseState(upper, SUCCESS, FAILURE) {\n    var upperCode = upper.charCodeAt(0);\n    var lowerCode = upper.toLowerCase().charCodeAt(0);\n    return function (t, c) {\n        if (c === lowerCode || c === upperCode) {\n            t._state = SUCCESS;\n        }\n        else {\n            t._state = FAILURE;\n            t._index--;\n        }\n    };\n}\nvar stateBeforeCdata1 = ifElseState(\"C\", 24 /* BeforeCdata2 */, 16 /* InDeclaration */);\nvar stateBeforeCdata2 = ifElseState(\"D\", 25 /* BeforeCdata3 */, 16 /* InDeclaration */);\nvar stateBeforeCdata3 = ifElseState(\"A\", 26 /* BeforeCdata4 */, 16 /* InDeclaration */);\nvar stateBeforeCdata4 = ifElseState(\"T\", 27 /* BeforeCdata5 */, 16 /* InDeclaration */);\nvar stateBeforeCdata5 = ifElseState(\"A\", 28 /* BeforeCdata6 */, 16 /* InDeclaration */);\nvar stateBeforeScript1 = ifElseState(\"R\", 35 /* BeforeScript2 */, 3 /* InTagName */);\nvar stateBeforeScript2 = ifElseState(\"I\", 36 /* BeforeScript3 */, 3 /* InTagName */);\nvar stateBeforeScript3 = ifElseState(\"P\", 37 /* BeforeScript4 */, 3 /* InTagName */);\nvar stateBeforeScript4 = ifElseState(\"T\", 38 /* BeforeScript5 */, 3 /* InTagName */);\nvar stateAfterScript1 = ifElseState(\"R\", 40 /* AfterScript2 */, 1 /* Text */);\nvar stateAfterScript2 = ifElseState(\"I\", 41 /* AfterScript3 */, 1 /* Text */);\nvar stateAfterScript3 = ifElseState(\"P\", 42 /* AfterScript4 */, 1 /* Text */);\nvar stateAfterScript4 = ifElseState(\"T\", 43 /* AfterScript5 */, 1 /* Text */);\nvar stateBeforeStyle1 = ifElseState(\"Y\", 45 /* BeforeStyle2 */, 3 /* InTagName */);\nvar stateBeforeStyle2 = ifElseState(\"L\", 46 /* BeforeStyle3 */, 3 /* InTagName */);\nvar stateBeforeStyle3 = ifElseState(\"E\", 47 /* BeforeStyle4 */, 3 /* InTagName */);\nvar stateAfterStyle1 = ifElseState(\"Y\", 49 /* AfterStyle2 */, 1 /* Text */);\nvar stateAfterStyle2 = ifElseState(\"L\", 50 /* AfterStyle3 */, 1 /* Text */);\nvar stateAfterStyle3 = ifElseState(\"E\", 51 /* AfterStyle4 */, 1 /* Text */);\nvar stateBeforeSpecialT = ifElseState(\"I\", 54 /* BeforeTitle1 */, 3 /* InTagName */);\nvar stateBeforeTitle1 = ifElseState(\"T\", 55 /* BeforeTitle2 */, 3 /* InTagName */);\nvar stateBeforeTitle2 = ifElseState(\"L\", 56 /* BeforeTitle3 */, 3 /* InTagName */);\nvar stateBeforeTitle3 = ifElseState(\"E\", 57 /* BeforeTitle4 */, 3 /* InTagName */);\nvar stateBeforeSpecialTEnd = ifElseState(\"I\", 58 /* AfterTitle1 */, 1 /* Text */);\nvar stateAfterTitle1 = ifElseState(\"T\", 59 /* AfterTitle2 */, 1 /* Text */);\nvar stateAfterTitle2 = ifElseState(\"L\", 60 /* AfterTitle3 */, 1 /* Text */);\nvar stateAfterTitle3 = ifElseState(\"E\", 61 /* AfterTitle4 */, 1 /* Text */);\nvar stateBeforeNumericEntity = ifElseState(\"X\", 66 /* InHexEntity */, 65 /* InNumericEntity */);\nvar Tokenizer = /** @class */ (function () {\n    function Tokenizer(_a, cbs) {\n        var _b = _a.xmlMode, xmlMode = _b === void 0 ? false : _b, _c = _a.decodeEntities, decodeEntities = _c === void 0 ? true : _c;\n        this.cbs = cbs;\n        /** The current state the tokenizer is in. */\n        this._state = 1 /* Text */;\n        /** The read buffer. */\n        this.buffer = \"\";\n        /** The beginning of the section that is currently being read. */\n        this.sectionStart = 0;\n        /** The index within the buffer that we are currently looking at. */\n        this._index = 0;\n        /**\n         * Data that has already been processed will be removed from the buffer occasionally.\n         * `_bufferOffset` keeps track of how many characters have been removed, to make sure position information is accurate.\n         */\n        this.bufferOffset = 0;\n        /** Some behavior, eg. when decoding entities, is done while we are in another state. This keeps track of the other state type. */\n        this.baseState = 1 /* Text */;\n        /** For special parsing behavior inside of script and style tags. */\n        this.special = 1 /* None */;\n        /** Indicates whether the tokenizer has been paused. */\n        this.running = true;\n        /** Indicates whether the tokenizer has finished running / `.end` has been called. */\n        this.ended = false;\n        this.trieIndex = 0;\n        this.trieCurrent = 0;\n        this.trieResult = null;\n        this.trieExcess = 0;\n        this.xmlMode = xmlMode;\n        this.decodeEntities = decodeEntities;\n        this.entityTrie = xmlMode ? decode_1.xmlDecodeTree : decode_1.htmlDecodeTree;\n    }\n    Tokenizer.prototype.reset = function () {\n        this._state = 1 /* Text */;\n        this.buffer = \"\";\n        this.sectionStart = 0;\n        this._index = 0;\n        this.bufferOffset = 0;\n        this.baseState = 1 /* Text */;\n        this.special = 1 /* None */;\n        this.running = true;\n        this.ended = false;\n    };\n    Tokenizer.prototype.write = function (chunk) {\n        if (this.ended)\n            return this.cbs.onerror(Error(\".write() after done!\"));\n        if (this.buffer.length)\n            this.buffer += chunk;\n        else\n            this.buffer = chunk;\n        this.parse();\n    };\n    Tokenizer.prototype.end = function (chunk) {\n        if (this.ended)\n            return this.cbs.onerror(Error(\".end() after done!\"));\n        if (chunk)\n            this.write(chunk);\n        this.ended = true;\n        if (this.running)\n            this.finish();\n    };\n    Tokenizer.prototype.pause = function () {\n        this.running = false;\n    };\n    Tokenizer.prototype.resume = function () {\n        this.running = true;\n        if (this._index < this.buffer.length) {\n            this.parse();\n        }\n        if (this.ended) {\n            this.finish();\n        }\n    };\n    /**\n     * The start of the current section.\n     */\n    Tokenizer.prototype.getAbsoluteSectionStart = function () {\n        return this.sectionStart + this.bufferOffset;\n    };\n    /**\n     * The current index within all of the written data.\n     */\n    Tokenizer.prototype.getAbsoluteIndex = function () {\n        return this.bufferOffset + this._index;\n    };\n    Tokenizer.prototype.stateText = function (c) {\n        if (c === 60 /* Lt */) {\n            if (this._index > this.sectionStart) {\n                this.cbs.ontext(this.getSection());\n            }\n            this._state = 2 /* BeforeTagName */;\n            this.sectionStart = this._index;\n        }\n        else if (this.decodeEntities &&\n            c === 38 /* Amp */ &&\n            (this.special === 1 /* None */ || this.special === 4 /* Title */)) {\n            if (this._index > this.sectionStart) {\n                this.cbs.ontext(this.getSection());\n            }\n            this.baseState = 1 /* Text */;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    /**\n     * HTML only allows ASCII alpha characters (a-z and A-Z) at the beginning of a tag name.\n     *\n     * XML allows a lot more characters here (@see https://www.w3.org/TR/REC-xml/#NT-NameStartChar).\n     * We allow anything that wouldn't end the tag.\n     */\n    Tokenizer.prototype.isTagStartChar = function (c) {\n        return (isASCIIAlpha(c) ||\n            (this.xmlMode &&\n                !whitespace(c) &&\n                c !== 47 /* Slash */ &&\n                c !== 62 /* Gt */));\n    };\n    Tokenizer.prototype.stateBeforeTagName = function (c) {\n        if (c === 47 /* Slash */) {\n            this._state = 5 /* BeforeClosingTagName */;\n        }\n        else if (c === 60 /* Lt */) {\n            this.cbs.ontext(this.getSection());\n            this.sectionStart = this._index;\n        }\n        else if (c === 62 /* Gt */ ||\n            this.special !== 1 /* None */ ||\n            whitespace(c)) {\n            this._state = 1 /* Text */;\n        }\n        else if (c === 33 /* ExclamationMark */) {\n            this._state = 15 /* BeforeDeclaration */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === 63 /* Questionmark */) {\n            this._state = 17 /* InProcessingInstruction */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (!this.isTagStartChar(c)) {\n            this._state = 1 /* Text */;\n        }\n        else {\n            this._state =\n                !this.xmlMode &&\n                    (c === 115 /* LowerS */ || c === 83 /* UpperS */)\n                    ? 32 /* BeforeSpecialS */\n                    : !this.xmlMode &&\n                        (c === 116 /* LowerT */ || c === 84 /* UpperT */)\n                        ? 52 /* BeforeSpecialT */\n                        : 3 /* InTagName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInTagName = function (c) {\n        if (c === 47 /* Slash */ || c === 62 /* Gt */ || whitespace(c)) {\n            this.cbs.onopentagname(this.getSection());\n            this.sectionStart = -1;\n            this._state = 8 /* BeforeAttributeName */;\n            this.stateBeforeAttributeName(c);\n        }\n    };\n    Tokenizer.prototype.stateBeforeClosingTagName = function (c) {\n        if (whitespace(c)) {\n            // Ignore\n        }\n        else if (c === 62 /* Gt */) {\n            this._state = 1 /* Text */;\n        }\n        else if (this.special !== 1 /* None */) {\n            if (this.special !== 4 /* Title */ &&\n                (c === 115 /* LowerS */ || c === 83 /* UpperS */)) {\n                this._state = 33 /* BeforeSpecialSEnd */;\n            }\n            else if (this.special === 4 /* Title */ &&\n                (c === 116 /* LowerT */ || c === 84 /* UpperT */)) {\n                this._state = 53 /* BeforeSpecialTEnd */;\n            }\n            else {\n                this._state = 1 /* Text */;\n                this.stateText(c);\n            }\n        }\n        else if (!this.isTagStartChar(c)) {\n            this._state = 20 /* InSpecialComment */;\n            this.sectionStart = this._index;\n        }\n        else {\n            this._state = 6 /* InClosingTagName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInClosingTagName = function (c) {\n        if (c === 62 /* Gt */ || whitespace(c)) {\n            this.cbs.onclosetag(this.getSection());\n            this.sectionStart = -1;\n            this._state = 7 /* AfterClosingTagName */;\n            this.stateAfterClosingTagName(c);\n        }\n    };\n    Tokenizer.prototype.stateAfterClosingTagName = function (c) {\n        // Skip everything until \">\"\n        if (c === 62 /* Gt */) {\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateBeforeAttributeName = function (c) {\n        if (c === 62 /* Gt */) {\n            this.cbs.onopentagend();\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === 47 /* Slash */) {\n            this._state = 4 /* InSelfClosingTag */;\n        }\n        else if (!whitespace(c)) {\n            this._state = 9 /* InAttributeName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInSelfClosingTag = function (c) {\n        if (c === 62 /* Gt */) {\n            this.cbs.onselfclosingtag();\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n            this.special = 1 /* None */; // Reset special state, in case of self-closing special tags\n        }\n        else if (!whitespace(c)) {\n            this._state = 8 /* BeforeAttributeName */;\n            this.stateBeforeAttributeName(c);\n        }\n    };\n    Tokenizer.prototype.stateInAttributeName = function (c) {\n        if (c === 61 /* Eq */ ||\n            c === 47 /* Slash */ ||\n            c === 62 /* Gt */ ||\n            whitespace(c)) {\n            this.cbs.onattribname(this.getSection());\n            this.sectionStart = -1;\n            this._state = 10 /* AfterAttributeName */;\n            this.stateAfterAttributeName(c);\n        }\n    };\n    Tokenizer.prototype.stateAfterAttributeName = function (c) {\n        if (c === 61 /* Eq */) {\n            this._state = 11 /* BeforeAttributeValue */;\n        }\n        else if (c === 47 /* Slash */ || c === 62 /* Gt */) {\n            this.cbs.onattribend(undefined);\n            this._state = 8 /* BeforeAttributeName */;\n            this.stateBeforeAttributeName(c);\n        }\n        else if (!whitespace(c)) {\n            this.cbs.onattribend(undefined);\n            this._state = 9 /* InAttributeName */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateBeforeAttributeValue = function (c) {\n        if (c === 34 /* DoubleQuote */) {\n            this._state = 12 /* InAttributeValueDq */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c === 39 /* SingleQuote */) {\n            this._state = 13 /* InAttributeValueSq */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (!whitespace(c)) {\n            this.sectionStart = this._index;\n            this._state = 14 /* InAttributeValueNq */;\n            this.stateInAttributeValueNoQuotes(c); // Reconsume token\n        }\n    };\n    Tokenizer.prototype.handleInAttributeValue = function (c, quote) {\n        if (c === quote) {\n            this.cbs.onattribdata(this.getSection());\n            this.sectionStart = -1;\n            this.cbs.onattribend(String.fromCharCode(quote));\n            this._state = 8 /* BeforeAttributeName */;\n        }\n        else if (this.decodeEntities && c === 38 /* Amp */) {\n            this.cbs.onattribdata(this.getSection());\n            this.baseState = this._state;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateInAttributeValueDoubleQuotes = function (c) {\n        this.handleInAttributeValue(c, 34 /* DoubleQuote */);\n    };\n    Tokenizer.prototype.stateInAttributeValueSingleQuotes = function (c) {\n        this.handleInAttributeValue(c, 39 /* SingleQuote */);\n    };\n    Tokenizer.prototype.stateInAttributeValueNoQuotes = function (c) {\n        if (whitespace(c) || c === 62 /* Gt */) {\n            this.cbs.onattribdata(this.getSection());\n            this.sectionStart = -1;\n            this.cbs.onattribend(null);\n            this._state = 8 /* BeforeAttributeName */;\n            this.stateBeforeAttributeName(c);\n        }\n        else if (this.decodeEntities && c === 38 /* Amp */) {\n            this.cbs.onattribdata(this.getSection());\n            this.baseState = this._state;\n            this._state = 62 /* BeforeEntity */;\n            this.sectionStart = this._index;\n        }\n    };\n    Tokenizer.prototype.stateBeforeDeclaration = function (c) {\n        this._state =\n            c === 91 /* OpeningSquareBracket */\n                ? 23 /* BeforeCdata1 */\n                : c === 45 /* Dash */\n                    ? 18 /* BeforeComment */\n                    : 16 /* InDeclaration */;\n    };\n    Tokenizer.prototype.stateInDeclaration = function (c) {\n        if (c === 62 /* Gt */) {\n            this.cbs.ondeclaration(this.getSection());\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateInProcessingInstruction = function (c) {\n        if (c === 62 /* Gt */) {\n            this.cbs.onprocessinginstruction(this.getSection());\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateBeforeComment = function (c) {\n        if (c === 45 /* Dash */) {\n            this._state = 19 /* InComment */;\n            this.sectionStart = this._index + 1;\n        }\n        else {\n            this._state = 16 /* InDeclaration */;\n        }\n    };\n    Tokenizer.prototype.stateInComment = function (c) {\n        if (c === 45 /* Dash */)\n            this._state = 21 /* AfterComment1 */;\n    };\n    Tokenizer.prototype.stateInSpecialComment = function (c) {\n        if (c === 62 /* Gt */) {\n            this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n    };\n    Tokenizer.prototype.stateAfterComment1 = function (c) {\n        if (c === 45 /* Dash */) {\n            this._state = 22 /* AfterComment2 */;\n        }\n        else {\n            this._state = 19 /* InComment */;\n        }\n    };\n    Tokenizer.prototype.stateAfterComment2 = function (c) {\n        if (c === 62 /* Gt */) {\n            // Remove 2 trailing chars\n            this.cbs.oncomment(this.buffer.substring(this.sectionStart, this._index - 2));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c !== 45 /* Dash */) {\n            this._state = 19 /* InComment */;\n        }\n        // Else: stay in AFTER_COMMENT_2 (`--->`)\n    };\n    Tokenizer.prototype.stateBeforeCdata6 = function (c) {\n        if (c === 91 /* OpeningSquareBracket */) {\n            this._state = 29 /* InCdata */;\n            this.sectionStart = this._index + 1;\n        }\n        else {\n            this._state = 16 /* InDeclaration */;\n            this.stateInDeclaration(c);\n        }\n    };\n    Tokenizer.prototype.stateInCdata = function (c) {\n        if (c === 93 /* ClosingSquareBracket */)\n            this._state = 30 /* AfterCdata1 */;\n    };\n    Tokenizer.prototype.stateAfterCdata1 = function (c) {\n        if (c === 93 /* ClosingSquareBracket */)\n            this._state = 31 /* AfterCdata2 */;\n        else\n            this._state = 29 /* InCdata */;\n    };\n    Tokenizer.prototype.stateAfterCdata2 = function (c) {\n        if (c === 62 /* Gt */) {\n            // Remove 2 trailing chars\n            this.cbs.oncdata(this.buffer.substring(this.sectionStart, this._index - 2));\n            this._state = 1 /* Text */;\n            this.sectionStart = this._index + 1;\n        }\n        else if (c !== 93 /* ClosingSquareBracket */) {\n            this._state = 29 /* InCdata */;\n        }\n        // Else: stay in AFTER_CDATA_2 (`]]]>`)\n    };\n    Tokenizer.prototype.stateBeforeSpecialS = function (c) {\n        if (c === 99 /* LowerC */ || c === 67 /* UpperC */) {\n            this._state = 34 /* BeforeScript1 */;\n        }\n        else if (c === 116 /* LowerT */ || c === 84 /* UpperT */) {\n            this._state = 44 /* BeforeStyle1 */;\n        }\n        else {\n            this._state = 3 /* InTagName */;\n            this.stateInTagName(c); // Consume the token again\n        }\n    };\n    Tokenizer.prototype.stateBeforeSpecialSEnd = function (c) {\n        if (this.special === 2 /* Script */ &&\n            (c === 99 /* LowerC */ || c === 67 /* UpperC */)) {\n            this._state = 39 /* AfterScript1 */;\n        }\n        else if (this.special === 3 /* Style */ &&\n            (c === 116 /* LowerT */ || c === 84 /* UpperT */)) {\n            this._state = 48 /* AfterStyle1 */;\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    Tokenizer.prototype.stateBeforeSpecialLast = function (c, special) {\n        if (c === 47 /* Slash */ || c === 62 /* Gt */ || whitespace(c)) {\n            this.special = special;\n        }\n        this._state = 3 /* InTagName */;\n        this.stateInTagName(c); // Consume the token again\n    };\n    Tokenizer.prototype.stateAfterSpecialLast = function (c, sectionStartOffset) {\n        if (c === 62 /* Gt */ || whitespace(c)) {\n            this.sectionStart = this._index - sectionStartOffset;\n            this.special = 1 /* None */;\n            this._state = 6 /* InClosingTagName */;\n            this.stateInClosingTagName(c); // Reconsume the token\n        }\n        else\n            this._state = 1 /* Text */;\n    };\n    Tokenizer.prototype.stateBeforeEntity = function (c) {\n        if (c === 35 /* Num */) {\n            this._state = 63 /* BeforeNumericEntity */;\n        }\n        else if (c === 38 /* Amp */) {\n            // We have two `&` characters in a row. Emit the first one.\n            this.emitPartial(this.getSection());\n            this.sectionStart = this._index;\n        }\n        else {\n            this._state = 64 /* InNamedEntity */;\n            this.trieIndex = 0;\n            this.trieCurrent = this.entityTrie[0];\n            this.trieResult = null;\n            // Start excess with 1 to include the '&'\n            this.trieExcess = 1;\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInNamedEntity = function (c) {\n        this.trieExcess += 1;\n        this.trieIndex = (0, decode_1.determineBranch)(this.entityTrie, this.trieCurrent, this.trieIndex + 1, c);\n        if (this.trieIndex < 0) {\n            this.emitNamedEntity();\n            this._index--;\n            return;\n        }\n        this.trieCurrent = this.entityTrie[this.trieIndex];\n        // If the branch is a value, store it and continue\n        if (this.trieCurrent & decode_1.BinTrieFlags.HAS_VALUE) {\n            // If we have a legacy entity while parsing strictly, just skip the number of bytes\n            if (!this.allowLegacyEntity() && c !== 59 /* Semi */) {\n                // No need to consider multi-byte values, as the legacy entity is always a single byte\n                this.trieIndex += 1;\n            }\n            else {\n                // If this is a surrogate pair, combine the higher bits from the node with the next byte\n                this.trieResult =\n                    this.trieCurrent & decode_1.BinTrieFlags.MULTI_BYTE\n                        ? String.fromCharCode(this.entityTrie[++this.trieIndex], this.entityTrie[++this.trieIndex])\n                        : String.fromCharCode(this.entityTrie[++this.trieIndex]);\n                this.trieExcess = 0;\n            }\n        }\n    };\n    Tokenizer.prototype.emitNamedEntity = function () {\n        if (this.trieResult) {\n            this.emitPartial(this.trieResult);\n        }\n        this.sectionStart = this._index - this.trieExcess + 1;\n        this._state = this.baseState;\n    };\n    Tokenizer.prototype.decodeNumericEntity = function (base, strict) {\n        var sectionStart = this.sectionStart + 2 + (base >> 4);\n        if (sectionStart !== this._index) {\n            // Parse entity\n            var entity = this.buffer.substring(sectionStart, this._index);\n            var parsed = parseInt(entity, base);\n            this.emitPartial((0, decode_codepoint_1.default)(parsed));\n            this.sectionStart = this._index + Number(strict);\n        }\n        this._state = this.baseState;\n    };\n    Tokenizer.prototype.stateInNumericEntity = function (c) {\n        if (c === 59 /* Semi */) {\n            this.decodeNumericEntity(10, true);\n        }\n        else if (c < 48 /* Zero */ || c > 57 /* Nine */) {\n            if (this.allowLegacyEntity()) {\n                this.decodeNumericEntity(10, false);\n            }\n            else {\n                this._state = this.baseState;\n            }\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.stateInHexEntity = function (c) {\n        if (c === 59 /* Semi */) {\n            this.decodeNumericEntity(16, true);\n        }\n        else if ((c < 97 /* LowerA */ || c > 102 /* LowerF */) &&\n            (c < 65 /* UpperA */ || c > 70 /* UpperF */) &&\n            (c < 48 /* Zero */ || c > 57 /* Nine */)) {\n            if (this.allowLegacyEntity()) {\n                this.decodeNumericEntity(16, false);\n            }\n            else {\n                this._state = this.baseState;\n            }\n            this._index--;\n        }\n    };\n    Tokenizer.prototype.allowLegacyEntity = function () {\n        return !this.xmlMode && this.baseState === 1 /* Text */;\n    };\n    /**\n     * Remove data that has already been consumed from the buffer.\n     */\n    Tokenizer.prototype.cleanup = function () {\n        // If we are inside of text, emit what we already have.\n        if (this.running &&\n            this._state === 1 /* Text */ &&\n            this.sectionStart !== this._index) {\n            // TODO: We could emit attribute data here as well.\n            this.cbs.ontext(this.buffer.substr(this.sectionStart));\n            this.sectionStart = this._index;\n        }\n        var start = this.sectionStart < 0 ? this._index : this.sectionStart;\n        this.buffer =\n            start === this.buffer.length ? \"\" : this.buffer.substr(start);\n        this._index -= start;\n        this.bufferOffset += start;\n        if (this.sectionStart > 0) {\n            this.sectionStart = 0;\n        }\n    };\n    /**\n     * Iterates through the buffer, calling the function corresponding to the current state.\n     *\n     * States that are more likely to be hit are higher up, as a performance improvement.\n     */\n    Tokenizer.prototype.parse = function () {\n        while (this._index < this.buffer.length && this.running) {\n            var c = this.buffer.charCodeAt(this._index);\n            if (this._state === 1 /* Text */) {\n                this.stateText(c);\n            }\n            else if (this._state === 12 /* InAttributeValueDq */) {\n                this.stateInAttributeValueDoubleQuotes(c);\n            }\n            else if (this._state === 9 /* InAttributeName */) {\n                this.stateInAttributeName(c);\n            }\n            else if (this._state === 19 /* InComment */) {\n                this.stateInComment(c);\n            }\n            else if (this._state === 20 /* InSpecialComment */) {\n                this.stateInSpecialComment(c);\n            }\n            else if (this._state === 8 /* BeforeAttributeName */) {\n                this.stateBeforeAttributeName(c);\n            }\n            else if (this._state === 3 /* InTagName */) {\n                this.stateInTagName(c);\n            }\n            else if (this._state === 6 /* InClosingTagName */) {\n                this.stateInClosingTagName(c);\n            }\n            else if (this._state === 2 /* BeforeTagName */) {\n                this.stateBeforeTagName(c);\n            }\n            else if (this._state === 10 /* AfterAttributeName */) {\n                this.stateAfterAttributeName(c);\n            }\n            else if (this._state === 13 /* InAttributeValueSq */) {\n                this.stateInAttributeValueSingleQuotes(c);\n            }\n            else if (this._state === 11 /* BeforeAttributeValue */) {\n                this.stateBeforeAttributeValue(c);\n            }\n            else if (this._state === 5 /* BeforeClosingTagName */) {\n                this.stateBeforeClosingTagName(c);\n            }\n            else if (this._state === 7 /* AfterClosingTagName */) {\n                this.stateAfterClosingTagName(c);\n            }\n            else if (this._state === 32 /* BeforeSpecialS */) {\n                this.stateBeforeSpecialS(c);\n            }\n            else if (this._state === 21 /* AfterComment1 */) {\n                this.stateAfterComment1(c);\n            }\n            else if (this._state === 14 /* InAttributeValueNq */) {\n                this.stateInAttributeValueNoQuotes(c);\n            }\n            else if (this._state === 4 /* InSelfClosingTag */) {\n                this.stateInSelfClosingTag(c);\n            }\n            else if (this._state === 16 /* InDeclaration */) {\n                this.stateInDeclaration(c);\n            }\n            else if (this._state === 15 /* BeforeDeclaration */) {\n                this.stateBeforeDeclaration(c);\n            }\n            else if (this._state === 22 /* AfterComment2 */) {\n                this.stateAfterComment2(c);\n            }\n            else if (this._state === 18 /* BeforeComment */) {\n                this.stateBeforeComment(c);\n            }\n            else if (this._state === 33 /* BeforeSpecialSEnd */) {\n                this.stateBeforeSpecialSEnd(c);\n            }\n            else if (this._state === 53 /* BeforeSpecialTEnd */) {\n                stateBeforeSpecialTEnd(this, c);\n            }\n            else if (this._state === 39 /* AfterScript1 */) {\n                stateAfterScript1(this, c);\n            }\n            else if (this._state === 40 /* AfterScript2 */) {\n                stateAfterScript2(this, c);\n            }\n            else if (this._state === 41 /* AfterScript3 */) {\n                stateAfterScript3(this, c);\n            }\n            else if (this._state === 34 /* BeforeScript1 */) {\n                stateBeforeScript1(this, c);\n            }\n            else if (this._state === 35 /* BeforeScript2 */) {\n                stateBeforeScript2(this, c);\n            }\n            else if (this._state === 36 /* BeforeScript3 */) {\n                stateBeforeScript3(this, c);\n            }\n            else if (this._state === 37 /* BeforeScript4 */) {\n                stateBeforeScript4(this, c);\n            }\n            else if (this._state === 38 /* BeforeScript5 */) {\n                this.stateBeforeSpecialLast(c, 2 /* Script */);\n            }\n            else if (this._state === 42 /* AfterScript4 */) {\n                stateAfterScript4(this, c);\n            }\n            else if (this._state === 43 /* AfterScript5 */) {\n                this.stateAfterSpecialLast(c, 6);\n            }\n            else if (this._state === 44 /* BeforeStyle1 */) {\n                stateBeforeStyle1(this, c);\n            }\n            else if (this._state === 29 /* InCdata */) {\n                this.stateInCdata(c);\n            }\n            else if (this._state === 45 /* BeforeStyle2 */) {\n                stateBeforeStyle2(this, c);\n            }\n            else if (this._state === 46 /* BeforeStyle3 */) {\n                stateBeforeStyle3(this, c);\n            }\n            else if (this._state === 47 /* BeforeStyle4 */) {\n                this.stateBeforeSpecialLast(c, 3 /* Style */);\n            }\n            else if (this._state === 48 /* AfterStyle1 */) {\n                stateAfterStyle1(this, c);\n            }\n            else if (this._state === 49 /* AfterStyle2 */) {\n                stateAfterStyle2(this, c);\n            }\n            else if (this._state === 50 /* AfterStyle3 */) {\n                stateAfterStyle3(this, c);\n            }\n            else if (this._state === 51 /* AfterStyle4 */) {\n                this.stateAfterSpecialLast(c, 5);\n            }\n            else if (this._state === 52 /* BeforeSpecialT */) {\n                stateBeforeSpecialT(this, c);\n            }\n            else if (this._state === 54 /* BeforeTitle1 */) {\n                stateBeforeTitle1(this, c);\n            }\n            else if (this._state === 55 /* BeforeTitle2 */) {\n                stateBeforeTitle2(this, c);\n            }\n            else if (this._state === 56 /* BeforeTitle3 */) {\n                stateBeforeTitle3(this, c);\n            }\n            else if (this._state === 57 /* BeforeTitle4 */) {\n                this.stateBeforeSpecialLast(c, 4 /* Title */);\n            }\n            else if (this._state === 58 /* AfterTitle1 */) {\n                stateAfterTitle1(this, c);\n            }\n            else if (this._state === 59 /* AfterTitle2 */) {\n                stateAfterTitle2(this, c);\n            }\n            else if (this._state === 60 /* AfterTitle3 */) {\n                stateAfterTitle3(this, c);\n            }\n            else if (this._state === 61 /* AfterTitle4 */) {\n                this.stateAfterSpecialLast(c, 5);\n            }\n            else if (this._state === 17 /* InProcessingInstruction */) {\n                this.stateInProcessingInstruction(c);\n            }\n            else if (this._state === 64 /* InNamedEntity */) {\n                this.stateInNamedEntity(c);\n            }\n            else if (this._state === 23 /* BeforeCdata1 */) {\n                stateBeforeCdata1(this, c);\n            }\n            else if (this._state === 62 /* BeforeEntity */) {\n                this.stateBeforeEntity(c);\n            }\n            else if (this._state === 24 /* BeforeCdata2 */) {\n                stateBeforeCdata2(this, c);\n            }\n            else if (this._state === 25 /* BeforeCdata3 */) {\n                stateBeforeCdata3(this, c);\n            }\n            else if (this._state === 30 /* AfterCdata1 */) {\n                this.stateAfterCdata1(c);\n            }\n            else if (this._state === 31 /* AfterCdata2 */) {\n                this.stateAfterCdata2(c);\n            }\n            else if (this._state === 26 /* BeforeCdata4 */) {\n                stateBeforeCdata4(this, c);\n            }\n            else if (this._state === 27 /* BeforeCdata5 */) {\n                stateBeforeCdata5(this, c);\n            }\n            else if (this._state === 28 /* BeforeCdata6 */) {\n                this.stateBeforeCdata6(c);\n            }\n            else if (this._state === 66 /* InHexEntity */) {\n                this.stateInHexEntity(c);\n            }\n            else if (this._state === 65 /* InNumericEntity */) {\n                this.stateInNumericEntity(c);\n            }\n            else {\n                // `this._state === State.BeforeNumericEntity`\n                stateBeforeNumericEntity(this, c);\n            }\n            this._index++;\n        }\n        this.cleanup();\n    };\n    Tokenizer.prototype.finish = function () {\n        // If there is remaining data, emit it in a reasonable way\n        if (this.sectionStart < this._index) {\n            this.handleTrailingData();\n        }\n        this.cbs.onend();\n    };\n    /** Handle any trailing data. */\n    Tokenizer.prototype.handleTrailingData = function () {\n        var data = this.buffer.substr(this.sectionStart);\n        if (this._state === 29 /* InCdata */ ||\n            this._state === 30 /* AfterCdata1 */ ||\n            this._state === 31 /* AfterCdata2 */) {\n            this.cbs.oncdata(data);\n        }\n        else if (this._state === 19 /* InComment */ ||\n            this._state === 21 /* AfterComment1 */ ||\n            this._state === 22 /* AfterComment2 */) {\n            this.cbs.oncomment(data);\n        }\n        else if (this._state === 64 /* InNamedEntity */ && !this.xmlMode) {\n            // Increase excess for EOF\n            this.trieExcess++;\n            this.emitNamedEntity();\n            if (this.sectionStart < this._index) {\n                this._state = this.baseState;\n                this.handleTrailingData();\n            }\n        }\n        else if (this._state === 65 /* InNumericEntity */ && !this.xmlMode) {\n            this.decodeNumericEntity(10, false);\n            // All trailing data will have been consumed\n        }\n        else if (this._state === 66 /* InHexEntity */ && !this.xmlMode) {\n            this.decodeNumericEntity(16, false);\n            // All trailing data will have been consumed\n        }\n        else if (this._state === 3 /* InTagName */ ||\n            this._state === 8 /* BeforeAttributeName */ ||\n            this._state === 11 /* BeforeAttributeValue */ ||\n            this._state === 10 /* AfterAttributeName */ ||\n            this._state === 9 /* InAttributeName */ ||\n            this._state === 13 /* InAttributeValueSq */ ||\n            this._state === 12 /* InAttributeValueDq */ ||\n            this._state === 14 /* InAttributeValueNq */ ||\n            this._state === 6 /* InClosingTagName */) {\n            /*\n             * If we are currently in an opening or closing tag, us not calling the\n             * respective callback signals that the tag should be ignored.\n             */\n        }\n        else {\n            this.cbs.ontext(data);\n        }\n    };\n    Tokenizer.prototype.getSection = function () {\n        return this.buffer.substring(this.sectionStart, this._index);\n    };\n    Tokenizer.prototype.emitPartial = function (value) {\n        if (this.baseState !== 1 /* Text */) {\n            this.cbs.onattribdata(value);\n        }\n        else {\n            this.cbs.ontext(value);\n        }\n    };\n    return Tokenizer;\n}());\nexports.default = Tokenizer;\n"]},"metadata":{},"sourceType":"script"}